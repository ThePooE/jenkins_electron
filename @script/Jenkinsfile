#!groovy
node {
    /** Downloading Stage */
    //def job = Jenkins.instance.getItem("jenkin_groovy")
    stage 'Download'
    checkout scm
    def mvnHome = tool 'M3'

    /** Setting-up Stage */
    stage 'Setup'
    bat 'npm run package-properties'
    def file = readTrusted('package-properties.txt')
    echo "${env.BUILD_ID}"
    bat 'npm uninstall *'

    /** Building Stage */
    stage 'Build'
    bat 'npm install'

    /** Testing Stage */
    stage 'Test'
    bat 'npm run e2e'
    bat 'npm run coverage'

    /** Packaging Stage */
    stage 'Package'
    bat 'npm run packWin'
    archiveArtifacts artifacts: '**', onlyIfSuccessful: true
    deleteDir()
}